{% extends 'base.html' %}
{% block content %}
<h2>Review Your Order</h2>
{% if unavailable|length > 0 %}
<div class="error-message">
  <strong>Some items are no longer available:</strong>
  <ul style="margin: 8px 0 0 20px;">
    {% for item in unavailable %}
    <li>{{ item }}</li>
    {% endfor %}
  </ul>
  <a href="/cart" style="display: inline-block; margin-top: 12px; color: var(--primary-color);">← Go back to cart</a>
</div>
{% else %}
<div style="background: white; padding: 24px; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 24px;">
  <h3 style="margin: 0 0 20px 0;">Order Summary</h3>
  <table>
    <thead>
      <tr>
        <th>Item</th>
        <th>Quantity</th>
        <th>Unit Price</th>
        <th>Subtotal</th>
      </tr>
    </thead>
    <tbody>
    {% for ci in cart_items %}
      <tr>
        <td>
          <strong>{{ ci.item.name }}</strong>
          <div style="font-size: 13px; color: #686b78; margin-top: 4px;">{{ ci.item.description }}</div>
        </td>
        <td>{{ ci.quantity }}</td>
        <td>₹{{ '%.2f' % (ci.item.price_cents/100) }}</td>
        <td><strong>₹{{ '%.2f' % ((ci.item.price_cents*ci.quantity)/100) }}</strong></td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
  <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e5e7eb; text-align: right;">
    <div style="font-size: 24px; font-weight: 700; color: var(--text-dark);">
      Total: ₹{{ '%.2f' % (total_cents/100) }}
    </div>
  </div>
</div>

<div style="display: flex; gap: 16px; justify-content: center;">
  <a href="/cart" class="btn" style="background: #6c757d; display: inline-block;">← Back to Cart</a>
  <form method="post" action="/payment/create-order" style="display: inline;">
    <button type="submit" class="btn" style="padding: 16px 32px; font-size: 18px;">Proceed to Payment →</button>
  </form>
</div>
{% endif %}
{% endblock %}

